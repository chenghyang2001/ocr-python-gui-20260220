# Feature Specification: OCR 圖片文字辨識桌面應用程式（檔案／剪貼簿來源）

**Feature Branch**: `002-ocr-file-clipboard`
**Created**: 2026-02-20
**Status**: Draft
**Input**: User description: "來源的圖片有兩種方式：一是提供檔案路徑，另一種是圖片已經在 system clipboard 裡，直接從 system clipboard 捉取來源圖片做 OCR。不需要支持批次處理"

## User Scenarios & Testing *(mandatory)*

### User Story 1 - 從檔案載入圖片進行 OCR 辨識 (Priority: P1)

使用者開啟應用程式，透過檔案選擇器選取一張圖片檔案（如掃描文件、螢幕截圖），選擇辨識語言（繁體中文、簡體中文、英文），點擊辨識按鈕後，系統在結果區域顯示辨識出的文字。使用者可將全部結果一鍵複製到系統剪貼簿，或選取部分文字複製。

**Why this priority**: 從檔案載入是最基本且明確的使用路徑，完成此 story 即擁有完整的輸入→辨識→輸出流程，可作為 MVP 交付。

**Independent Test**: 開啟應用 → 點擊「載入圖片」選擇一張含繁體中文的 PNG → 點擊「辨識」→ 確認辨識文字出現 → 點擊「複製」→ 在記事本貼上驗證。

**Acceptance Scenarios**:

1. **Given** 應用程式已開啟且無圖片載入, **When** 使用者點擊「載入圖片」並選擇一張 PNG 檔案, **Then** 圖片顯示在預覽區域，辨識按鈕變為可用狀態
2. **Given** 圖片已載入且語言選擇為「繁體中文」, **When** 使用者點擊「辨識」按鈕, **Then** 系統顯示處理中指示器，完成後在結果區域顯示辨識出的文字
3. **Given** 辨識結果已顯示, **When** 使用者點擊「複製到剪貼簿」按鈕, **Then** 全部辨識文字被複製到系統剪貼簿，並顯示複製成功的提示
4. **Given** 辨識結果已顯示, **When** 使用者在結果區域中選取部分文字並按 Ctrl+C, **Then** 僅選取的文字被複製到系統剪貼簿

---

### User Story 2 - 從系統剪貼簿擷取圖片進行 OCR 辨識 (Priority: P1)

使用者在其他應用程式中截圖或複製圖片後，切換到本應用程式，點擊「從剪貼簿貼上」按鈕（或按 Ctrl+V），系統自動從系統剪貼簿讀取圖片並顯示預覽。使用者選擇語言後點擊辨識，流程與檔案載入相同。

**Why this priority**: 剪貼簿輸入是本應用的核心差異化功能，與檔案載入同為 P1。許多使用者的工作流程是「截圖 → 立即辨識」，剪貼簿輸入省去了先存檔再載入的步驟。

**Independent Test**: 在瀏覽器截取一段含英文的畫面（Win+Shift+S）→ 切換到應用程式 → 點擊「從剪貼簿貼上」→ 圖片出現在預覽區 → 辨識 → 確認結果。

**Acceptance Scenarios**:

1. **Given** 系統剪貼簿中有一張圖片（如使用者剛用截圖工具截取）, **When** 使用者點擊「從剪貼簿貼上」按鈕, **Then** 剪貼簿中的圖片顯示在預覽區域，辨識按鈕變為可用狀態
2. **Given** 系統剪貼簿中有一張圖片, **When** 使用者在應用程式中按 Ctrl+V, **Then** 效果與點擊「從剪貼簿貼上」按鈕相同
3. **Given** 系統剪貼簿中沒有圖片（例如只有文字）, **When** 使用者點擊「從剪貼簿貼上」, **Then** 系統顯示提示訊息：「剪貼簿中沒有圖片」
4. **Given** 從剪貼簿貼上的圖片已顯示在預覽區, **When** 使用者選擇語言並點擊「辨識」, **Then** 辨識流程與從檔案載入完全一致

---

### User Story 3 - 匯出辨識結果為文字檔 (Priority: P2)

使用者完成辨識後，可將結果匯出為純文字檔（.txt）儲存到本機。

**Why this priority**: 匯出讓辨識結果可長期保存，完善從輸入到持久化輸出的完整工作流程。但因使用者已可透過剪貼簿將結果帶到其他應用程式，匯出為次要需求。

**Independent Test**: 完成一次辨識 → 點擊「匯出」→ 選擇儲存位置 → 確認 .txt 檔案內容與辨識結果一致。

**Acceptance Scenarios**:

1. **Given** 辨識結果已顯示, **When** 使用者點擊「匯出」按鈕, **Then** 出現儲存對話框，預設檔案類型為 .txt，檔名若來源為檔案則預設為原檔名
2. **Given** 使用者選擇儲存路徑並確認, **When** 系統寫入檔案, **Then** 產生的 .txt 檔使用 UTF-8 編碼，內容與結果區域的文字完全一致
3. **Given** 辨識來源為剪貼簿（無原始檔名）, **When** 使用者點擊「匯出」, **Then** 預設檔名為 "ocr-result-YYYYMMDD-HHMMSS.txt"（含時間戳記）

---

### Edge Cases

- 使用者載入不支援的檔案格式（如 .pdf、.gif）時，系統顯示明確的錯誤提示，說明支援的格式清單
- 圖片完全空白或無可辨識文字時，系統顯示「未偵測到文字」的友善提示
- 極大圖片（超過 50MB）載入時，系統顯示載入進度或給予效能警告
- 辨識過程中應用程式 MUST NOT 凍結，使用者仍可操作介面
- 系統剪貼簿操作失敗（如權限問題）時，顯示明確錯誤訊息
- 使用者在辨識完成前再次點擊「辨識」按鈕時，按鈕為停用狀態以防重複觸發
- 匯出時目標路徑不可寫入（如權限不足），系統顯示錯誤並允許重新選擇路徑

## Requirements *(mandatory)*

### Functional Requirements

- **FR-001**: 系統 MUST 支援透過檔案選擇器載入 PNG、JPG/JPEG、BMP、TIFF 格式的圖片
- **FR-002**: 系統 MUST 支援從系統剪貼簿讀取圖片，透過按鈕點擊或 Ctrl+V 快捷鍵觸發
- **FR-003**: 系統 MUST 支援繁體中文、簡體中文、英文三種語言的 OCR 辨識
- **FR-004**: 使用者 MUST 能在辨識前選擇目標語言（可多選，用於混合語言文件）
- **FR-005**: 系統 MUST 在辨識過程中顯示進度指示，且介面保持回應狀態
- **FR-006**: 使用者 MUST 能將全部辨識結果一鍵複製到系統剪貼簿
- **FR-007**: 使用者 MUST 能在結果區域中選取部分文字並複製
- **FR-008**: 系統 MUST 支援將辨識結果匯出為 UTF-8 編碼的 .txt 純文字檔案
- **FR-009**: 系統 MUST 在圖片載入（無論來源）後顯示圖片預覽
- **FR-010**: 系統 MUST 在剪貼簿中無圖片時提供清楚的使用者提示
- **FR-011**: 系統 MUST 對不支援的檔案格式顯示明確的錯誤訊息

### Key Entities

- **圖片來源（Image Source）**: 使用者提供的圖片，來源方式為「檔案」或「剪貼簿」，包含圖片資料、來源類型、原始檔名（檔案來源時）
- **辨識設定（Recognition Settings）**: 使用者選擇的辨識參數，目前僅包含目標語言（一或多種）
- **辨識結果（Recognition Result）**: 辨識產生的文字內容，關聯對應的圖片來源與辨識設定

## Success Criteria *(mandatory)*

### Measurable Outcomes

- **SC-001**: 使用者從開啟應用到完成辨識並取得結果，透過檔案路徑 MUST 在 3 次點擊內完成（載入、辨識、複製）
- **SC-002**: 使用者從剪貼簿截圖到取得辨識結果，MUST 在 2 次點擊內完成（貼上、辨識——結果自動顯示可直接複製）
- **SC-003**: 單張標準文件圖片（A4、300DPI）的辨識處理時間 MUST 在 10 秒以內
- **SC-004**: 繁體中文、簡體中文、英文清晰印刷文件的辨識準確率 SHOULD 達到 90% 以上
- **SC-005**: 辨識過程中介面 MUST 持續回應使用者操作（不凍結）
- **SC-006**: 首次使用者無需查閱說明文件即可完成辨識操作（介面直覺易懂）

### Assumptions

- 主要使用情境：使用者截圖後立即辨識（剪貼簿流程），或載入既有圖片檔案辨識
- 主要目標為印刷體文字辨識，手寫體辨識不在首要範圍內
- 應用程式為單機桌面應用，不需要網路連線即可辨識（使用離線 OCR 引擎）
- Windows 為主要目標平台
- 不需要批次處理功能——每次僅處理一張圖片
- GUI 框架與 OCR 引擎的具體選擇由實作規劃階段決定
